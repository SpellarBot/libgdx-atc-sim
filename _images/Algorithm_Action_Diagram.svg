<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1606px" preserveAspectRatio="none" style="width:1308px;height:1606px;" version="1.1" viewBox="0 0 1308 1606" width="1308px" zoomAndPan="magnify"><defs><filter height="300%" id="f7eufbs8vufea" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="760.25" cy="20" fill="#000000" filter="url(#f7eufbs8vufea)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="330" x="595.25" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="310" x="605.25" y="71.1387">Project coordinates into Gnomonic/Stereographic</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="116" x="605.25" y="85.1074">coordinate system</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="290" x="615.25" y="117.9375"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="270" x="625.25" y="139.0762">Calculate centre circle offset amount using</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="192" x="625.25" y="153.0449">time since last state transition</text><rect fill="#FFFFFF" filter="url(#f7eufbs8vufea)" height="342.0381" style="stroke: #000000; stroke-width: 2.0;" width="711" x="486.5" y="176.6768"/><path d="M596.5,177.6768 L596.5,185.9736 L586.5,195.9736 L486.5,195.9736 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="100" x="489.5" y="190.6719">TurnDetection</text><polygon fill="#FEFECE" filter="url(#f7eufbs8vufea)" points="694.75,212.1719,825.75,212.1719,837.75,224.1719,825.75,236.1719,694.75,236.1719,682.75,224.1719,694.75,212.1719" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="131" x="694.75" y="227.98">Number of track points</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="650.75" y="221.5776">n==3</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="837.75" y="221.5776">n!=3</text><rect fill="#FFFFFF" filter="url(#f7eufbs8vufea)" height="104.2344" style="stroke: #000000; stroke-width: 2.0;" width="199" x="506.5" y="246.1719"/><path d="M636.5,247.1719 L636.5,255.4688 L626.5,265.4688 L506.5,265.4688 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120" x="509.5" y="260.167">3PointsDetection</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="516.5" y="282.4688"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="121" x="526.5" y="303.6074">Circle from 3 points</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="159" x="526.5" y="317.5762">(perpendicular bisectors)</text><rect fill="#FFFFFF" filter="url(#f7eufbs8vufea)" height="178.1406" style="stroke: #000000; stroke-width: 2.0;" width="358" x="735.5" y="294.5742"/><path d="M916.5,295.5742 L916.5,303.8711 L906.5,313.8711 L735.5,313.8711 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="171" x="738.5" y="308.5693">MovingWindowDetection</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="298" x="765.5" y="330.8711"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="234" x="775.5" y="352.0098">Create Beta (guess circle) from start,</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="278" x="775.5" y="365.9785">middle and end points of the moving window</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="61.9063" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="338" x="745.5" y="398.8086"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="318" x="755.5" y="419.9473">Fit circle using Levenberg-Marquardt least squares</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="311" x="755.5" y="433.916">optimization onto the moving window of positions,</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="245" x="755.5" y="447.8848">using the beta circle as starting values</text><polygon fill="#FEFECE" filter="url(#f7eufbs8vufea)" points="849,246.1719,980,246.1719,992,258.1719,980,270.1719,849,270.1719,837,258.1719,849,246.1719" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="23" x="918.5" y="280.3823">n&gt;3</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="131" x="849" y="261.98">Number of track points</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="32" x="992" y="255.5776">n&lt;=3</text><ellipse cx="1044" cy="258.1719" fill="none" filter="url(#f7eufbs8vufea)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="1044.5" cy="258.6719" fill="#000000" filter="url(#f7eufbs8vufea)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><polygon fill="#FEFECE" filter="url(#f7eufbs8vufea)" points="760.25,482.7148,772.25,494.7148,760.25,506.7148,748.25,494.7148,760.25,482.7148" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FFFFFF" filter="url(#f7eufbs8vufea)" height="972.4902" style="stroke: #000000; stroke-width: 2.0;" width="1287" x="10" y="529.5166"/><path d="M121,530.5166 L121,538.8135 L111,548.8135 L10,548.8135 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="101" x="13" y="543.5117">TurnPrediction</text><polygon fill="#FEFECE" filter="url(#f7eufbs8vufea)" points="673.75,565.0117,846.75,565.0117,858.75,577.0117,846.75,589.0117,673.75,589.0117,661.75,577.0117,673.75,565.0117" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="173" x="673.75" y="580.8198">Circle radius within threshold?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="641.75" y="574.4175">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="858.75" y="574.4175">no</text><rect fill="#FFFFFF" filter="url(#f7eufbs8vufea)" height="860.9951" style="stroke: #000000; stroke-width: 2.0;" width="827" x="30" y="599.0117"/><path d="M135,600.0117 L135,608.3086 L125,618.3086 L30,618.3086 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="95" x="33" y="613.0068">CirclePrection</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="225" x="331" y="634.5068"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="205" x="341" y="655.6455">Calculate the offset centre circle</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="307" x="290" y="688.4756"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="287" x="300" y="709.6143">Calculate the angular velocities of the aircraft</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="237" x="300" y="723.583">as if it were travelling on these circles</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="251" x="318" y="756.4131"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="231" x="328" y="777.5518">Calculate turn direction (left or right)</text><polygon fill="#FEFECE" filter="url(#f7eufbs8vufea)" points="401,825.3818,486,825.3818,498,837.3818,486,849.3818,401,849.3818,389,837.3818,401,825.3818" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="401" y="841.1899">Turn direction?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="18" x="371" y="834.7876">left</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="26" x="498" y="834.7876">right</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="226" x="205.5" y="859.3818"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="206" x="215.5" y="880.5205">Set algorithm state = LEFT_TURN</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="234" x="451.5" y="859.3818"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="214" x="461.5" y="880.5205">Set algorithm state = RIGHT_TURN</text><polygon fill="#FEFECE" filter="url(#f7eufbs8vufea)" points="443.5,899.3506,455.5,911.3506,443.5,923.3506,431.5,911.3506,443.5,899.3506" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="270" x="308.5" y="958.3506"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="250" x="318.5" y="979.4893">For each prediction point in the number</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="166" x="318.5" y="993.458">of predictions to be made:</text><rect fill="#000000" filter="url(#f7eufbs8vufea)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="807" x="40" y="1026.2881"/><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="343.25" y="1052.2881"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="159" x="353.25" y="1073.4268">Increment a time counter</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="336" x="264.75" y="1106.2568"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="316" x="274.75" y="1127.3955">Calculate angular distance around circle given the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="289" x="274.75" y="1141.3643">angular velocity multiplied by the time counter</text><polygon fill="#FEFECE" filter="url(#f7eufbs8vufea)" points="347.25,1174.1943,518.25,1174.1943,530.25,1186.1943,518.25,1198.1943,347.25,1198.1943,335.25,1186.1943,347.25,1174.1943" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="171" x="347.25" y="1190.0024">angular distance is too great?</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="20" x="315.25" y="1183.6001">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="530.25" y="1183.6001">no</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="61.9063" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="348" x="64" y="1208.1943"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="328" x="74" y="1229.333">Calculate predicted positions for centre and outside</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="284" x="74" y="1243.3018">circles using a linear prediction based off the</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="325" x="74" y="1257.2705">previous predicted position, and the change in time</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="391" x="432" y="1208.1943"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="371" x="442" y="1229.333">Calculate predicted positions on centre and outside circles</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="169" x="442" y="1243.3018">using the angular distance</text><polygon fill="#FEFECE" filter="url(#f7eufbs8vufea)" points="432.75,1276.1006,444.75,1288.1006,432.75,1300.1006,420.75,1288.1006,432.75,1276.1006" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="256" x="304.75" y="1320.1006"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="236" x="314.75" y="1341.2393">Check to see that the predictions are</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="119" x="314.75" y="1355.208">physically plausible</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="321" x="272.25" y="1388.0381"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="301" x="282.25" y="1409.1768">Add predicted positions to the prediction tracks</text><rect fill="#000000" filter="url(#f7eufbs8vufea)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="807" x="40" y="1442.0068"/><rect fill="#FFFFFF" filter="url(#f7eufbs8vufea)" height="401.3076" style="stroke: #000000; stroke-width: 2.0;" width="400" x="877" y="599.0117"/><path d="M997,600.0117 L997,608.3086 L987,618.3086 L877,618.3086 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="110" x="880" y="613.0068">LinearPrediction</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="218" x="968" y="634.5068"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="198" x="978" y="655.6455">Set algorithm state = STRAIGHT</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="47.9375" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="270" x="942" y="688.4756"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="250" x="952" y="709.6143">For each prediction point in the number</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="166" x="952" y="723.583">of predictions to be made:</text><rect fill="#000000" filter="url(#f7eufbs8vufea)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="380" x="887" y="756.4131"/><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="352" x="901" y="782.4131"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="332" x="911" y="803.5518">Calculate predicted position using a linear prediction</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="262" x="946" y="851.3818"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="242" x="956" y="872.5205">Check prediction is physically plausible</text><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="289" x="932.5" y="920.3506"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="269" x="942.5" y="941.4893">Add predicted position to prediction tracks</text><rect fill="#000000" filter="url(#f7eufbs8vufea)" height="6" rx="2.5" ry="2.5" style="stroke: #000000; stroke-width: 1.0;" width="380" x="887" y="974.3193"/><polygon fill="#FEFECE" filter="url(#f7eufbs8vufea)" points="760.25,1466.0068,772.25,1478.0068,760.25,1490.0068,748.25,1478.0068,760.25,1466.0068" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f7eufbs8vufea)" height="33.9688" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="285" x="617.75" y="1522.0068"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="265" x="627.75" y="1543.1455">Create prediction using tracks, and return</text><ellipse cx="760.25" cy="1585.9756" fill="none" filter="url(#f7eufbs8vufea)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="760.75" cy="1586.4756" fill="#000000" filter="url(#f7eufbs8vufea)" rx="6" ry="6" style="stroke: none; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="760.25" x2="760.25" y1="30" y2="50"/><polygon fill="#A80036" points="756.25,40,760.25,50,764.25,40,760.25,44" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="760.25" x2="760.25" y1="97.9375" y2="117.9375"/><polygon fill="#A80036" points="756.25,107.9375,760.25,117.9375,764.25,107.9375,760.25,111.9375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="914.5" x2="914.5" y1="378.8086" y2="398.8086"/><polygon fill="#A80036" points="910.5,388.8086,914.5,398.8086,918.5,388.8086,914.5,392.8086" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="914.5" x2="914.5" y1="270.1719" y2="330.8711"/><polygon fill="#A80036" points="910.5,320.8711,914.5,330.8711,918.5,320.8711,914.5,324.8711" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="992" x2="1034" y1="258.1719" y2="258.1719"/><polygon fill="#A80036" points="1024,254.1719,1034,258.1719,1024,262.1719,1028,258.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="914.5" x2="914.5" y1="460.7148" y2="494.7148"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="914.5" x2="772.25" y1="494.7148" y2="494.7148"/><polygon fill="#A80036" points="782.25,490.7148,772.25,494.7148,782.25,498.7148,778.25,494.7148" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="682.75" x2="606" y1="224.1719" y2="224.1719"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="606" x2="606" y1="224.1719" y2="282.4688"/><polygon fill="#A80036" points="602,272.4688,606,282.4688,610,272.4688,606,276.4688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="837.75" x2="914.5" y1="224.1719" y2="224.1719"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="914.5" x2="914.5" y1="224.1719" y2="246.1719"/><polygon fill="#A80036" points="910.5,236.1719,914.5,246.1719,918.5,236.1719,914.5,240.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="606" x2="606" y1="330.4063" y2="494.7148"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="606" x2="748.25" y1="494.7148" y2="494.7148"/><polygon fill="#A80036" points="738.25,490.7148,748.25,494.7148,738.25,498.7148,742.25,494.7148" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="760.25" x2="760.25" y1="165.875" y2="212.1719"/><polygon fill="#A80036" points="756.25,202.1719,760.25,212.1719,764.25,202.1719,760.25,206.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="443.5" x2="443.5" y1="668.4756" y2="688.4756"/><polygon fill="#A80036" points="439.5,678.4756,443.5,688.4756,447.5,678.4756,443.5,682.4756" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="443.5" x2="443.5" y1="736.4131" y2="756.4131"/><polygon fill="#A80036" points="439.5,746.4131,443.5,756.4131,447.5,746.4131,443.5,750.4131" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="389" x2="318.5" y1="837.3818" y2="837.3818"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="318.5" x2="318.5" y1="837.3818" y2="859.3818"/><polygon fill="#A80036" points="314.5,849.3818,318.5,859.3818,322.5,849.3818,318.5,853.3818" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="498" x2="568.5" y1="837.3818" y2="837.3818"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="568.5" x2="568.5" y1="837.3818" y2="859.3818"/><polygon fill="#A80036" points="564.5,849.3818,568.5,859.3818,572.5,849.3818,568.5,853.3818" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="318.5" x2="318.5" y1="893.3506" y2="911.3506"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="318.5" x2="431.5" y1="911.3506" y2="911.3506"/><polygon fill="#A80036" points="421.5,907.3506,431.5,911.3506,421.5,915.3506,425.5,911.3506" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="568.5" x2="568.5" y1="893.3506" y2="911.3506"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="568.5" x2="455.5" y1="911.3506" y2="911.3506"/><polygon fill="#A80036" points="465.5,907.3506,455.5,911.3506,465.5,915.3506,461.5,911.3506" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="443.5" x2="443.5" y1="790.3818" y2="825.3818"/><polygon fill="#A80036" points="439.5,815.3818,443.5,825.3818,447.5,815.3818,443.5,819.3818" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="443.5" x2="443.5" y1="923.3506" y2="958.3506"/><polygon fill="#A80036" points="439.5,948.3506,443.5,958.3506,447.5,948.3506,443.5,952.3506" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="432.75" x2="432.75" y1="1086.2568" y2="1106.2568"/><polygon fill="#A80036" points="428.75,1096.2568,432.75,1106.2568,436.75,1096.2568,432.75,1100.2568" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="335.25" x2="238" y1="1186.1943" y2="1186.1943"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="238" x2="238" y1="1186.1943" y2="1208.1943"/><polygon fill="#A80036" points="234,1198.1943,238,1208.1943,242,1198.1943,238,1202.1943" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="530.25" x2="627.5" y1="1186.1943" y2="1186.1943"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="627.5" x2="627.5" y1="1186.1943" y2="1208.1943"/><polygon fill="#A80036" points="623.5,1198.1943,627.5,1208.1943,631.5,1198.1943,627.5,1202.1943" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="238" x2="238" y1="1270.1006" y2="1288.1006"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="238" x2="420.75" y1="1288.1006" y2="1288.1006"/><polygon fill="#A80036" points="410.75,1284.1006,420.75,1288.1006,410.75,1292.1006,414.75,1288.1006" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="627.5" x2="627.5" y1="1256.1318" y2="1288.1006"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="627.5" x2="444.75" y1="1288.1006" y2="1288.1006"/><polygon fill="#A80036" points="454.75,1284.1006,444.75,1288.1006,454.75,1292.1006,450.75,1288.1006" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="432.75" x2="432.75" y1="1154.1943" y2="1174.1943"/><polygon fill="#A80036" points="428.75,1164.1943,432.75,1174.1943,436.75,1164.1943,432.75,1168.1943" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="432.75" x2="432.75" y1="1300.1006" y2="1320.1006"/><polygon fill="#A80036" points="428.75,1310.1006,432.75,1320.1006,436.75,1310.1006,432.75,1314.1006" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="432.75" x2="432.75" y1="1368.0381" y2="1388.0381"/><polygon fill="#A80036" points="428.75,1378.0381,432.75,1388.0381,436.75,1378.0381,432.75,1382.0381" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="432.75" x2="432.75" y1="1032.2881" y2="1052.2881"/><polygon fill="#A80036" points="428.75,1042.2881,432.75,1052.2881,436.75,1042.2881,432.75,1046.2881" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="432.75" x2="432.75" y1="1422.0068" y2="1442.0068"/><polygon fill="#A80036" points="428.75,1432.0068,432.75,1442.0068,436.75,1432.0068,432.75,1436.0068" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="443.5" x2="443.5" y1="1006.2881" y2="1026.2881"/><polygon fill="#A80036" points="439.5,1016.2881,443.5,1026.2881,447.5,1016.2881,443.5,1020.2881" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1077" x2="1077" y1="668.4756" y2="688.4756"/><polygon fill="#A80036" points="1073,678.4756,1077,688.4756,1081,678.4756,1077,682.4756" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1077" x2="1077" y1="816.3818" y2="851.3818"/><polygon fill="#A80036" points="1073,841.3818,1077,851.3818,1081,841.3818,1077,845.3818" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1077" x2="1077" y1="885.3506" y2="920.3506"/><polygon fill="#A80036" points="1073,910.3506,1077,920.3506,1081,910.3506,1077,914.3506" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1077" x2="1077" y1="762.4131" y2="782.4131"/><polygon fill="#A80036" points="1073,772.4131,1077,782.4131,1081,772.4131,1077,776.4131" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1077" x2="1077" y1="954.3193" y2="974.3193"/><polygon fill="#A80036" points="1073,964.3193,1077,974.3193,1081,964.3193,1077,968.3193" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1077" x2="1077" y1="736.4131" y2="756.4131"/><polygon fill="#A80036" points="1073,746.4131,1077,756.4131,1081,746.4131,1077,750.4131" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="661.75" x2="443.5" y1="577.0117" y2="577.0117"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="443.5" x2="443.5" y1="577.0117" y2="634.5068"/><polygon fill="#A80036" points="439.5,624.5068,443.5,634.5068,447.5,624.5068,443.5,628.5068" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="858.75" x2="1077" y1="577.0117" y2="577.0117"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1077" x2="1077" y1="577.0117" y2="634.5068"/><polygon fill="#A80036" points="1073,624.5068,1077,634.5068,1081,624.5068,1077,628.5068" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="443.5" x2="443.5" y1="1448.0068" y2="1478.0068"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="443.5" x2="748.25" y1="1478.0068" y2="1478.0068"/><polygon fill="#A80036" points="738.25,1474.0068,748.25,1478.0068,738.25,1482.0068,742.25,1478.0068" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1077" x2="1077" y1="980.3193" y2="1478.0068"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1077" x2="772.25" y1="1478.0068" y2="1478.0068"/><polygon fill="#A80036" points="782.25,1474.0068,772.25,1478.0068,782.25,1482.0068,778.25,1478.0068" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="760.25" x2="760.25" y1="506.7148" y2="565.0117"/><polygon fill="#A80036" points="756.25,555.0117,760.25,565.0117,764.25,555.0117,760.25,559.0117" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="760.25" x2="760.25" y1="1490.0068" y2="1522.0068"/><polygon fill="#A80036" points="756.25,1512.0068,760.25,1522.0068,764.25,1512.0068,760.25,1516.0068" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="760.25" x2="760.25" y1="1555.9756" y2="1575.9756"/><polygon fill="#A80036" points="756.25,1565.9756,760.25,1575.9756,764.25,1565.9756,760.25,1569.9756" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
start
:Project coordinates into Gnomonic/Stereographic
coordinate system;
:Calculate centre circle offset amount using
time since last state transition;

partition TurnDetection {
  if (Number of track points) then (n==3)
    partition 3PointsDetection {
      :Circle from 3 points
      (perpendicular bisectors);
    }
  else (n!=3)
    if (Number of track points) then (n>3)
      partition MovingWindowDetection {
        :Create Beta (guess circle) from start,
        middle and end points of the moving window;
        :Fit circle using Levenberg-Marquardt least squares
        optimization onto the moving window of positions,
        using the beta circle as starting values;
      }
    else (n<=3)
      stop
    endif
  endif
}
partition TurnPrediction {
  if (Circle radius within threshold?) then (yes)
    partition CirclePrection {
      :Calculate the offset centre circle;
      :Calculate the angular velocities of the aircraft
      as if it were travelling on these circles;
      :Calculate turn direction (left or right);
      if (Turn direction?) then (left)
        :Set algorithm state = LEFT_TURN;
      else (right)
        :Set algorithm state = RIGHT_TURN;
      endif

      :For each prediction point in the number
      of predictions to be made:;

      fork
      :Increment a time counter;
      :Calculate angular distance around circle given the
      angular velocity multiplied by the time counter;

      if (angular distance is too great?) then (yes)
        :Calculate predicted positions for centre and outside
        circles using a linear prediction based off the
        previous predicted position, and the change in time;
      else (no)
        :Calculate predicted positions on centre and outside circles
        using the angular distance;
      endif

      :Check to see that the predictions are
      physically plausible;

      :Add predicted positions to the prediction tracks;

      end fork

    }
  else (no)
    partition LinearPrediction {
      :Set algorithm state = STRAIGHT;

      :For each prediction point in the number
      of predictions to be made:;

      fork
      :Calculate predicted position using a linear prediction;
      :Check prediction is physically plausible;
      :Add predicted position to prediction tracks;
      end fork
    }
  endif
}

:Create prediction using tracks, and return;

stop
@enduml

PlantUML version 1.2018.05(Sun May 06 06:00:17 AEST 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_162-b12
Operating System: Linux
OS Version: 4.16.3-1-ARCH
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>